# AJ. アクセシビリティ

## 概要

アクセシビリティは、障害者・高齢者・一時的な制限のあるユーザーを含むすべてのユーザーが等しくコンテンツにアクセスできることを保証する設計原則です。

慈善活動ではなく、ビジネスの責任であり、全ユーザーの体験を向上させる仕組みです。

---

## 1. WCAG 2.1 の基準

**4つの原則（POUR）:**

1. **Perceivable（知覚可能）**
   - 画像に alt 属性を追加
   - 情報は様々な方法で提示可能（視覚・音声・触覚）
   - テキストと背景のコントラストが4.5:1以上

2. **Operable（操作可能）**
   - すべての機能がキーボードだけで操作可能
   - フォーカス順が論理的
   - タイムアウト前に警告を表示

3. **Understandable（理解可能）**
   - テキストがシンプルで分かりやすい
   - ページ操作が予測可能
   - フォームエラーを明確に表示

4. **Robust（堅牢）**
   - HTMLはW3C仕様に準拠
   - セマンティックHTML、WAI-ARIAを正しく使用

**適合レベル:**
- **AA（推奨）** - 公開Webサイトの標準目標
- **AAA（最高）** - 一部コンテンツのみ、学習サイト向け

---

## 2. スクリーンリーダー対応

**セマンティックHTML の活用:**
```html
<header> ... </header>    <!-- サイト全体のナビゲーション -->
<nav> ... </nav>          <!-- メインメニュー -->
<main> ... </main>        <!-- ページ主要コンテンツ -->
<article> ... </article>  <!-- ブログ記事、ニュース -->
<button> ... </button>    <!-- クリック可能なアクション -->
<form> ... </form>        <!-- 入力フォーム -->
```

**スクリーンリーダー対応チェックリスト:**
- [ ] h1 > h2 > h3 の階層構造
- [ ] 画像にすべて alt 属性
- [ ] リンクテキストが「ここ」ではなく目的を明記
- [ ] フォームラベルがインプットに関連付け
- [ ] 色以外で情報を伝える（アイコン・テキスト併用）
- [ ] 動的コンテンツが aria-live で通知される

---

## 3. キーボード操作対応

**基本操作:**
- **Tab キー** - 次の要素へフォーカス移動
- **Shift + Tab** - 前の要素へ戻る
- **Enter キー** - ボタン・リンクを実行
- **Escape キー** - モーダル・ポップアップを閉じる

**実装:**
```javascript
// フォーカス枠を明確にする
button:focus {
  outline: 3px solid #0052CC;
  outline-offset: 2px;
}

// Escape キーでモーダルを閉じる
document.addEventListener('keydown', (e) => {
  if (e.key === 'Escape') {
    modal.style.display = 'none';
    openButton.focus();
  }
});
```

**テスト方法:**
- [ ] マウスなしでキーボードだけで全操作可能か
- [ ] Tab で全ページ要素にアクセス可能か
- [ ] フォーカス位置が常に視覚的に明確か
- [ ] 論理的な順序で移動するか

---

## 4. カラーコントラストと色の使用

**コントラスト比の基準:**
- **AA（最小）** - 4.5:1（通常テキスト）、3:1（大きなテキスト）
- **AAA（推奨）** - 7:1（通常テキスト）、4.5:1（大きなテキスト）

**色の使用:**
```html
<!-- 悪い例：色だけで情報を伝える -->
<span style="color: red;">エラーが発生しました</span>

<!-- 良い例：アイコン + テキスト + 属性 -->
<span style="color: red;" role="alert">
  ⚠️ エラーが発生しました
</span>
```

---

## 5. アクセシブルなフォーム

```html
<form id="loginForm">
  <!-- label でラベルを関連付け -->
  <label for="email">メールアドレス</label>
  <input
    id="email"
    type="email"
    required
    aria-required="true"
    aria-describedby="email-help"
  >
  <span id="email-help">登録時に使用したメールアドレス</span>

  <!-- エラー表示を aria-live で通知 -->
  <div id="error" role="alert" aria-live="polite"></div>
</form>
```

---

## 6. 動的コンテンツと ARIA

```html
<!-- カート数が更新される時 -->
<div aria-live="polite" aria-atomic="true">
  カート内の商品: 0個
</div>

<!-- 装飾用アイコンはスクリーンリーダーから隠す -->
<button>
  <span aria-hidden="true">★</span>
  お気に入りに追加
</button>
```

---

## 7. アクセシビリティ チェックリスト

**構造:**
- [ ] セマンティックHTML を使用
- [ ] 見出しが正しく階層化
- [ ] キーボードだけで全機能が操作可能

**視覚:**
- [ ] コントラスト比が4.5:1以上
- [ ] 色だけで情報を伝えない
- [ ] フォーカス枠が常に視覚的に明確

**コンテンツ:**
- [ ] 画像に alt 属性
- [ ] リンクテキストが明確
- [ ] 動画にキャプション

**テスト:**
- [ ] キーボード操作テスト実施
- [ ] スクリーンリーダー（NVDA等）でテスト
- [ ] axe DevTools で自動チェック
